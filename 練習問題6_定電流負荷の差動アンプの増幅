import numpy as np  # 数値計算ライブラリをインポート

# トランスコンダクタンスと出力コンダクタンスのパラメータ設定
# gm1は入力側MOSFETのトランスコンダクタンス（伝達コンダクタンス）で、MOSFETの動作においてゲインに寄与
# gds2およびgds4は、出力側MOSFETのドレイン・ソース間の出力コンダクタンス
# これらの値はMOSFETの電流-電圧特性により決まり、回路の増幅特性を左右する
gm1 = 1e-3  # トランスコンダクタンス g_m1 (S)
gds2 = 2e-5  # 出力コンダクタンス g_ds2 (S)
gds4 = 3e-5  # 出力コンダクタンス g_ds4 (S)

# ゲインの計算 (倍数表現)
# 式: Av = gm1 / (gds2 + gds4)
# 差動増幅回路のゲインを計算し、倍数で表現
# この式は、MOSFET負荷を持つ差動増幅回路のゲインの一般式で、トランスコンダクタンスと出力コンダクタンスに依存
# 詳細は https://aicdesign.org/wp-content/uploads/2018/08/lecture19-150211.pdf 参照
gain = gm1 / (gds2 + gds4)

# ゲインの計算 (デシベル表現)
# 式: Av(dB) = 20 * log10(Av)
# ゲインをデシベル (dB) で表現するために対数変換
# dBでのゲインは、増幅回路の効率や特性を評価する際に有用
gain_dB = 20 * np.log10(gain)

# 結果の表示
# 結果としてゲインを倍数とデシベル（dB）で表示し、回路の増幅特性を明確にする
print("ゲイン (v_out / v_in):", gain)  # ゲインの倍数表現 
print("ゲイン (dB):", gain_dB, "dB")   # ゲインのdB表現
